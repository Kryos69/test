--[[
    SpareStack UI Library v2.0
    A comprehensive Roblox UI library with all features
    
    Features:
    - Full component suite (Toggle, Slider, Button, Dropdown, Textbox, Keybind, ColorPicker, etc.)
    - Tab system with icons
    - Notification system
    - Configuration save/load
    - Draggable & resizable
    - Themes & customization
    - Search functionality
    - Animations
    
    Usage:
    loadstring(game:HttpGet("YOUR_URL"))()
]]--

local Library = {}
Library.__index = Library

-- Services
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local HttpService = game:GetService("HttpService")
local CoreGui = game:GetService("CoreGui")

-- Utility Functions
local function createInstance(className, properties)
    local instance = Instance.new(className)
    for k, v in pairs(properties) do
        if typeof(k) == 'string' then
            instance[k] = v
        end
    end
    return instance
end

local function tween(instance, properties, duration, style, direction)
    duration = duration or 0.3
    style = style or Enum.EasingStyle.Quad
    direction = direction or Enum.EasingDirection.Out
    
    local tweenInfo = TweenInfo.new(duration, style, direction)
    local tween = TweenService:Create(instance, tweenInfo, properties)
    tween:Play()
    return tween
end

local function ripple(button, x, y)
    spawn(function()
        local circle = createInstance("Frame", {
            Parent = button,
            BackgroundColor3 = Color3.fromRGB(255, 255, 255),
            BackgroundTransparency = 0.5,
            Size = UDim2.new(0, 0, 0, 0),
            Position = UDim2.new(0, x, 0, y),
            AnchorPoint = Vector2.new(0.5, 0.5),
            ZIndex = 100
        })
        
        createInstance("UICorner", {
            Parent = circle,
            CornerRadius = UDim.new(1, 0)
        })
        
        local size = math.max(button.AbsoluteSize.X, button.AbsoluteSize.Y) * 2
        tween(circle, {Size = UDim2.new(0, size, 0, size), BackgroundTransparency = 1}, 0.5)
        
        wait(0.5)
        circle:Destroy()
    end)
end

-- Theme System
local Themes = {
    Dark = {
        Background = Color3.fromRGB(20, 20, 27),
        Secondary = Color3.fromRGB(28, 28, 35),
        Accent = Color3.fromRGB(51, 105, 255),
        Text = Color3.fromRGB(255, 255, 255),
        SubText = Color3.fromRGB(178, 178, 178),
        Border = Color3.fromRGB(22, 22, 30),
        ElementBG = Color3.fromRGB(25, 25, 32),
        Hover = Color3.fromRGB(35, 35, 42)
    },
    Light = {
        Background = Color3.fromRGB(245, 245, 250),
        Secondary = Color3.fromRGB(255, 255, 255),
        Accent = Color3.fromRGB(51, 105, 255),
        Text = Color3.fromRGB(20, 20, 20),
        SubText = Color3.fromRGB(100, 100, 100),
        Border = Color3.fromRGB(225, 225, 230),
        ElementBG = Color3.fromRGB(250, 250, 255),
        Hover = Color3.fromRGB(240, 240, 245)
    },
    Midnight = {
        Background = Color3.fromRGB(10, 10, 15),
        Secondary = Color3.fromRGB(15, 15, 20),
        Accent = Color3.fromRGB(138, 43, 226),
        Text = Color3.fromRGB(255, 255, 255),
        SubText = Color3.fromRGB(150, 150, 150),
        Border = Color3.fromRGB(20, 20, 25),
        ElementBG = Color3.fromRGB(18, 18, 23),
        Hover = Color3.fromRGB(25, 25, 30)
    }
}

-- Main Library Constructor
function Library:New(config)
    config = config or {}
    
    local self = setmetatable({}, Library)
    
    -- Configuration
    self.Name = config.Name or "SpareStack"
    self.Theme = Themes[config.Theme] or Themes.Dark
    self.ConfigFolder = config.ConfigFolder or "SpareStack"
    self.Size = config.Size or UDim2.new(0, 650, 0, 500)
    self.Keybind = config.Keybind or Enum.KeyCode.RightControl
    
    -- State
    self.Tabs = {}
    self.CurrentTab = nil
    self.Flags = {}
    self.Notifications = {}
    
    -- Create UI
    self:CreateUI()
    self:SetupKeybind()
    
    return self
end

function Library:CreateUI()
    -- Screen GUI
    self.ScreenGui = createInstance("ScreenGui", {
        Name = "SpareStack_" .. math.random(1000, 9999),
        Parent = CoreGui,
        ZIndexBehavior = Enum.ZIndexBehavior.Sibling,
        ResetOnSpawn = false,
        IgnoreGuiInset = true
    })
    
    -- Main Container
    self.Main = createInstance("Frame", {
        Name = "Main",
        Parent = self.ScreenGui,
        Size = self.Size,
        Position = UDim2.new(0.5, 0, 0.5, 0),
        AnchorPoint = Vector2.new(0.5, 0.5),
        BackgroundColor3 = self.Theme.Background,
        BorderSizePixel = 0,
        ClipsDescendants = true
    })
    
    createInstance("UICorner", {
        Parent = self.Main,
        CornerRadius = UDim.new(0, 8)
    })
    
    createInstance("UIStroke", {
        Parent = self.Main,
        Color = self.Theme.Border,
        Thickness = 1.5,
        ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    })
    
    -- Topbar
    self.Topbar = createInstance("Frame", {
        Name = "Topbar",
        Parent = self.Main,
        Size = UDim2.new(1, 0, 0, 45),
        BackgroundColor3 = self.Theme.Secondary,
        BorderSizePixel = 0
    })
    
    createInstance("UICorner", {
        Parent = self.Topbar,
        CornerRadius = UDim.new(0, 8)
    })
    
    -- Bottom mask for topbar
    createInstance("Frame", {
        Parent = self.Topbar,
        Size = UDim2.new(1, 0, 0, 10),
        Position = UDim2.new(0, 0, 1, -10),
        BackgroundColor3 = self.Theme.Secondary,
        BorderSizePixel = 0
    })
    
    -- Title
    self.TitleLabel = createInstance("TextLabel", {
        Name = "Title",
        Parent = self.Topbar,
        Size = UDim2.new(0, 200, 1, 0),
        Position = UDim2.new(0, 15, 0, 0),
        BackgroundTransparency = 1,
        Text = self.Name,
        TextColor3 = self.Theme.Text,
        TextSize = 16,
        Font = Enum.Font.GothamBold,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    -- Close Button
    self.CloseButton = createInstance("TextButton", {
        Name = "Close",
        Parent = self.Topbar,
        Size = UDim2.new(0, 35, 0, 35),
        Position = UDim2.new(1, -40, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        BackgroundColor3 = self.Theme.ElementBG,
        Text = "×",
        TextColor3 = self.Theme.Text,
        TextSize = 20,
        Font = Enum.Font.GothamBold,
        BorderSizePixel = 0
    })
    
    createInstance("UICorner", {
        Parent = self.CloseButton,
        CornerRadius = UDim.new(0, 6)
    })
    
    self.CloseButton.MouseButton1Click:Connect(function()
        self:Toggle()
    end)
    
    self.CloseButton.MouseEnter:Connect(function()
        tween(self.CloseButton, {BackgroundColor3 = Color3.fromRGB(255, 50, 50)}, 0.2)
    end)
    
    self.CloseButton.MouseLeave:Connect(function()
        tween(self.CloseButton, {BackgroundColor3 = self.Theme.ElementBG}, 0.2)
    end)
    
    -- Minimize Button
    self.MinimizeButton = createInstance("TextButton", {
        Name = "Minimize",
        Parent = self.Topbar,
        Size = UDim2.new(0, 35, 0, 35),
        Position = UDim2.new(1, -80, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        BackgroundColor3 = self.Theme.ElementBG,
        Text = "−",
        TextColor3 = self.Theme.Text,
        TextSize = 20,
        Font = Enum.Font.GothamBold,
        BorderSizePixel = 0
    })
    
    createInstance("UICorner", {
        Parent = self.MinimizeButton,
        CornerRadius = UDim.new(0, 6)
    })
    
    self.MinimizeButton.MouseButton1Click:Connect(function()
        self:Minimize()
    end)
    
    self.MinimizeButton.MouseEnter:Connect(function()
        tween(self.MinimizeButton, {BackgroundColor3 = self.Theme.Hover}, 0.2)
    end)
    
    self.MinimizeButton.MouseLeave:Connect(function()
        tween(self.MinimizeButton, {BackgroundColor3 = self.Theme.ElementBG}, 0.2)
    end)
    
    -- Tab Container (Left Side)
    self.TabContainer = createInstance("Frame", {
        Name = "TabContainer",
        Parent = self.Main,
        Size = UDim2.new(0, 150, 1, -55),
        Position = UDim2.new(0, 10, 0, 50),
        BackgroundTransparency = 1,
        BorderSizePixel = 0
    })
    
    self.TabList = createInstance("ScrollingFrame", {
        Name = "TabList",
        Parent = self.TabContainer,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        BorderSizePixel = 0,
        ScrollBarThickness = 0,
        CanvasSize = UDim2.new(0, 0, 0, 0),
        AutomaticCanvasSize = Enum.AutomaticSize.Y
    })
    
    createInstance("UIListLayout", {
        Parent = self.TabList,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 5)
    })
    
    -- Content Container (Right Side)
    self.ContentContainer = createInstance("Frame", {
        Name = "ContentContainer",
        Parent = self.Main,
        Size = UDim2.new(1, -175, 1, -55),
        Position = UDim2.new(0, 165, 0, 50),
        BackgroundTransparency = 1,
        BorderSizePixel = 0,
        ClipsDescendants = true
    })
    
    -- Notification Container
    self.NotificationContainer = createInstance("Frame", {
        Name = "Notifications",
        Parent = self.ScreenGui,
        Size = UDim2.new(0, 300, 0, 0),
        Position = UDim2.new(1, -310, 0, 10),
        BackgroundTransparency = 1,
        BorderSizePixel = 0
    })
    
    createInstance("UIListLayout", {
        Parent = self.NotificationContainer,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 10),
        VerticalAlignment = Enum.VerticalAlignment.Bottom
    })
    
    -- Make draggable
    self:MakeDraggable()
end

function Library:MakeDraggable()
    local dragging, dragInput, dragStart, startPos
    
    self.Topbar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = self.Main.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    self.Topbar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            self.Main.Position = UDim2.new(
                startPos.X.Scale,
                startPos.X.Offset + delta.X,
                startPos.Y.Scale,
                startPos.Y.Offset + delta.Y
            )
        end
    end)
end

function Library:SetupKeybind()
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if not gameProcessed and input.KeyCode == self.Keybind then
            self:Toggle()
        end
    end)
end

function Library:Toggle()
    self.Main.Visible = not self.Main.Visible
end

function Library:Minimize()
    local targetSize
    if self.Main.Size.Y.Offset > 50 then
        targetSize = UDim2.new(self.Main.Size.X.Scale, self.Main.Size.X.Offset, 0, 45)
    else
        targetSize = self.Size
    end
    
    tween(self.Main, {Size = targetSize}, 0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.InOut)
end

-- Notification System
function Library:Notify(config)
    config = config or {}
    
    local title = config.Title or "Notification"
    local description = config.Description or ""
    local duration = config.Duration or 3
    local callback = config.Callback or function() end
    
    local notification = createInstance("Frame", {
        Name = "Notification",
        Parent = self.NotificationContainer,
        Size = UDim2.new(1, 0, 0, 0),
        BackgroundColor3 = self.Theme.Secondary,
        BorderSizePixel = 0
    })
    
    createInstance("UICorner", {
        Parent = notification,
        CornerRadius = UDim.new(0, 6)
    })
    
    createInstance("UIStroke", {
        Parent = notification,
        Color = self.Theme.Border,
        Thickness = 1
    })
    
    local padding = createInstance("UIPadding", {
        Parent = notification,
        PaddingLeft = UDim.new(0, 12),
        PaddingRight = UDim.new(0, 12),
        PaddingTop = UDim.new(0, 10),
        PaddingBottom = UDim.new(0, 10)
    })
    
    local titleLabel = createInstance("TextLabel", {
        Name = "Title",
        Parent = notification,
        Size = UDim2.new(1, 0, 0, 18),
        BackgroundTransparency = 1,
        Text = title,
        TextColor3 = self.Theme.Text,
        TextSize = 14,
        Font = Enum.Font.GothamBold,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    local descLabel = createInstance("TextLabel", {
        Name = "Description",
        Parent = notification,
        Size = UDim2.new(1, 0, 0, 0),
        Position = UDim2.new(0, 0, 0, 20),
        BackgroundTransparency = 1,
        Text = description,
        TextColor3 = self.Theme.SubText,
        TextSize = 12,
        Font = Enum.Font.Gotham,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextWrapped = true,
        AutomaticSize = Enum.AutomaticSize.Y
    })
    
    -- Calculate height
    local height = 30 + descLabel.TextBounds.Y
    notification.Size = UDim2.new(1, 0, 0, height)
    
    -- Animate in
    notification.Position = UDim2.new(0, 300, 0, 0)
    tween(notification, {Position = UDim2.new(0, 0, 0, 0)}, 0.3)
    
    -- Animate out after duration
    task.delay(duration, function()
        tween(notification, {Position = UDim2.new(0, 300, 0, 0)}, 0.3)
        task.wait(0.3)
        notification:Destroy()
    end)
    
    notification.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            callback()
            notification:Destroy()
        end
    end)
    
    return notification
end

-- Tab System
local Tab = {}
Tab.__index = Tab

function Library:CreateTab(config)
    config = config or {}
    
    local tab = setmetatable({
        Library = self,
        Name = config.Name or "Tab",
        Icon = config.Icon or "rbxassetid://7734053426"
    }, Tab)
    
    -- Tab Button
    tab.Button = createInstance("TextButton", {
        Name = tab.Name,
        Parent = self.TabList,
        Size = UDim2.new(1, 0, 0, 40),
        BackgroundColor3 = self.Theme.ElementBG,
        BorderSizePixel = 0,
        Text = "",
        AutoButtonColor = false
    })
    
    createInstance("UICorner", {
        Parent = tab.Button,
        CornerRadius = UDim.new(0, 6)
    })
    
    -- Tab Icon
    tab.IconImage = createInstance("ImageLabel", {
        Name = "Icon",
        Parent = tab.Button,
        Size = UDim2.new(0, 20, 0, 20),
        Position = UDim2.new(0, 10, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        BackgroundTransparency = 1,
        Image = tab.Icon,
        ImageColor3 = self.Theme.SubText
    })
    
    -- Tab Label
    tab.Label = createInstance("TextLabel", {
        Name = "Label",
        Parent = tab.Button,
        Size = UDim2.new(1, -45, 1, 0),
        Position = UDim2.new(0, 40, 0, 0),
        BackgroundTransparency = 1,
        Text = tab.Name,
        TextColor3 = self.Theme.SubText,
        TextSize = 13,
        Font = Enum.Font.GothamMedium,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    -- Tab Content
    tab.Content = createInstance("ScrollingFrame", {
        Name = tab.Name .. "_Content",
        Parent = self.ContentContainer,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        BorderSizePixel = 0,
        ScrollBarThickness = 6,
        ScrollBarImageColor3 = self.Theme.Accent,
        CanvasSize = UDim2.new(0, 0, 0, 0),
        AutomaticCanvasSize = Enum.AutomaticSize.Y,
        Visible = false
    })
    
    createInstance("UIPadding", {
        Parent = tab.Content,
        PaddingLeft = UDim.new(0, 10),
        PaddingRight = UDim.new(0, 10),
        PaddingTop = UDim.new(0, 10),
        PaddingBottom = UDim.new(0, 10)
    })
    
    createInstance("UIListLayout", {
        Parent = tab.Content,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 10)
    })
    
    -- Tab Button Click
    tab.Button.MouseButton1Click:Connect(function()
        self:SelectTab(tab)
    end)
    
    tab.Button.MouseEnter:Connect(function()
        if self.CurrentTab ~= tab then
            tween(tab.Button, {BackgroundColor3 = self.Theme.Hover}, 0.2)
        end
    end)
    
    tab.Button.MouseLeave:Connect(function()
        if self.CurrentTab ~= tab then
            tween(tab.Button, {BackgroundColor3 = self.Theme.ElementBG}, 0.2)
        end
    end)
    
    table.insert(self.Tabs, tab)
    
    if #self.Tabs == 1 then
        self:SelectTab(tab)
    end
    
    return tab
end

function Library:SelectTab(tab)
    -- Deselect current tab
    if self.CurrentTab then
        self.CurrentTab.Content.Visible = false
        tween(self.CurrentTab.Button, {BackgroundColor3 = self.Theme.ElementBG}, 0.2)
        tween(self.CurrentTab.Label, {TextColor3 = self.Theme.SubText}, 0.2)
        tween(self.CurrentTab.IconImage, {ImageColor3 = self.Theme.SubText}, 0.2)
    end
    
    -- Select new tab
    self.CurrentTab = tab
    tab.Content.Visible = true
    tween(tab.Button, {BackgroundColor3 = self.Theme.Accent}, 0.2)
    tween(tab.Label, {TextColor3 = self.Theme.Text}, 0.2)
    tween(tab.IconImage, {ImageColor3 = self.Theme.Text}, 0.2)
end

-- Components
function Tab:AddSection(name)
    local section = createInstance("Frame", {
        Name = "Section",
        Parent = self.Content,
        Size = UDim2.new(1, 0, 0, 30),
        BackgroundTransparency = 1,
        BorderSizePixel = 0
    })
    
    local label = createInstance("TextLabel", {
        Name = "Label",
        Parent = section,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        Text = name,
        TextColor3 = self.Library.Theme.Text,
        TextSize = 15,
        Font = Enum.Font.GothamBold,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    return section
end

function Tab:AddParagraph(title, content)
    local container = createInstance("Frame", {
        Name = "Paragraph",
        Parent = self.Content,
        Size = UDim2.new(1, 0, 0, 0),
        BackgroundColor3 = self.Library.Theme.ElementBG,
        BorderSizePixel = 0,
        AutomaticSize = Enum.AutomaticSize.Y
    })
    
    createInstance("UICorner", {
        Parent = container,
        CornerRadius = UDim.new(0, 6)
    })
    
    createInstance("UIPadding", {
        Parent = container,
        PaddingLeft = UDim.new(0, 12),
        PaddingRight = UDim.new(0, 12),
        PaddingTop = UDim.new(0, 10),
        PaddingBottom = UDim.new(0, 10)
    })
    
    local titleLabel = createInstance("TextLabel", {
        Name = "Title",
        Parent = container,
        Size = UDim2.new(1, 0, 0, 18),
        BackgroundTransparency = 1,
        Text = title,
        TextColor3 = self.Library.Theme.Text,
        TextSize = 13,
        Font = Enum.Font.GothamBold,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    local contentLabel = createInstance("TextLabel", {
        Name = "Content",
        Parent = container,
        Size = UDim2.new(1, 0, 0, 0),
        Position = UDim2.new(0, 0, 0, 20),
        BackgroundTransparency = 1,
        Text = content,
        TextColor3 = self.Library.Theme.SubText,
        TextSize = 12,
        Font = Enum.Font.Gotham,
        TextXAlignment = Enum.TextXAlignment.Left,
        TextWrapped = true,
        AutomaticSize = Enum.AutomaticSize.Y
    })
    
    return container
end

function Tab:AddButton(config)
    config = config or {}
    
    local name = config.Name or "Button"
    local callback = config.Callback or function() end
    
    local button = createInstance("TextButton", {
        Name = "Button",
        Parent = self.Content,
        Size = UDim2.new(1, 0, 0, 38),
        BackgroundColor3 = self.Library.Theme.ElementBG,
        BorderSizePixel = 0,
        Text = "",
        AutoButtonColor = false
    })
    
    createInstance("UICorner", {
        Parent = button,
        CornerRadius = UDim.new(0, 6)
    })
    
    local label = createInstance("TextLabel", {
        Name = "Label",
        Parent = button,
        Size = UDim2.new(1, -20, 1, 0),
        Position = UDim2.new(0, 10, 0, 0),
        BackgroundTransparency = 1,
        Text = name,
        TextColor3 = self.Library.Theme.Text,
        TextSize = 13,
        Font = Enum.Font.GothamMedium,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    button.MouseButton1Click:Connect(function()
        ripple(button, button.AbsoluteSize.X / 2, button.AbsoluteSize.Y / 2)
        callback()
    end)
    
    button.MouseEnter:Connect(function()
        tween(button, {BackgroundColor3 = self.Library.Theme.Hover}, 0.2)
    end)
    
    button.MouseLeave:Connect(function()
        tween(button, {BackgroundColor3 = self.Library.Theme.ElementBG}, 0.2)
    end)
    
    return button
end

function Tab:AddToggle(config)
    config = config or {}
    
    local name = config.Name or "Toggle"
    local default = config.Default or false
    local flag = config.Flag
    local callback = config.Callback or function() end
    
    local container = createInstance("Frame", {
        Name = "Toggle",
        Parent = self.Content,
        Size = UDim2.new(1, 0, 0, 38),
        BackgroundColor3 = self.Library.Theme.ElementBG,
        BorderSizePixel = 0
    })
    
    createInstance("UICorner", {
        Parent = container,
        CornerRadius = UDim.new(0, 6)
    })
    
    local label = createInstance("TextLabel", {
        Name = "Label",
        Parent = container,
        Size = UDim2.new(1, -60, 1, 0),
        Position = UDim2.new(0, 10, 0, 0),
        BackgroundTransparency = 1,
        Text = name,
        TextColor3 = self.Library.Theme.Text,
        TextSize = 13,
        Font = Enum.Font.GothamMedium,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    local toggleBackground = createInstance("Frame", {
        Name = "ToggleBG",
        Parent = container,
        Size = UDim2.new(0, 40, 0, 20),
        Position = UDim2.new(1, -50, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        BackgroundColor3 = self.Library.Theme.Border,
        BorderSizePixel = 0
    })
    
    createInstance("UICorner", {
        Parent = toggleBackground,
        CornerRadius = UDim.new(1, 0)
    })
    
    local toggleButton = createInstance("Frame", {
        Name = "ToggleButton",
        Parent = toggleBackground,
        Size = UDim2.new(0, 16, 0, 16),
        Position = UDim2.new(0, 2, 0.5, 0),
        AnchorPoint = Vector2.new(0, 0.5),
        BackgroundColor3 = Color3.fromRGB(255, 255, 255),
        BorderSizePixel = 0
    })
    
    createInstance("UICorner", {
        Parent = toggleButton,
        CornerRadius = UDim.new(1, 0)
    })
    
    local value = default
    
    local function update(newValue)
        value = newValue
        
        if value then
            tween(toggleBackground, {BackgroundColor3 = self.Library.Theme.Accent}, 0.2)
            tween(toggleButton, {Position = UDim2.new(1, -18, 0.5, 0)}, 0.2)
        else
            tween(toggleBackground, {BackgroundColor3 = self.Library.Theme.Border}, 0.2)
            tween(toggleButton, {Position = UDim2.new(0, 2, 0.5, 0)}, 0.2)
        end
        
        if flag then
            self.Library.Flags[flag] = value
        end
        
        callback(value)
    end
    
    local button = createInstance("TextButton", {
        Parent = container,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        Text = ""
    })
    
    button.MouseButton1Click:Connect(function()
        update(not value)
    end)
    
    button.MouseEnter:Connect(function()
        tween(container, {BackgroundColor3 = self.Library.Theme.Hover}, 0.2)
    end)
    
    button.MouseLeave:Connect(function()
        tween(container, {BackgroundColor3 = self.Library.Theme.ElementBG}, 0.2)
    end)
    
    update(default)
    
    return {
        SetValue = update,
        GetValue = function() return value end
    }
end

function Tab:AddSlider(config)
    config = config or {}
    
    local name = config.Name or "Slider"
    local min = config.Min or 0
    local max = config.Max or 100
    local default = config.Default or min
    local increment = config.Increment or 1
    local flag = config.Flag
    local callback = config.Callback or function() end
    
    local container = createInstance("Frame", {
        Name = "Slider",
        Parent = self.Content,
        Size = UDim2.new(1, 0, 0, 50),
        BackgroundColor3 = self.Library.Theme.ElementBG,
        BorderSizePixel = 0
    })
    
    createInstance("UICorner", {
        Parent = container,
        CornerRadius = UDim.new(0, 6)
    })
    
    local label = createInstance("TextLabel", {
        Name = "Label",
        Parent = container,
        Size = UDim2.new(1, -60, 0, 20),
        Position = UDim2.new(0, 10, 0, 8),
        BackgroundTransparency = 1,
        Text = name,
        TextColor3 = self.Library.Theme.Text,
        TextSize = 13,
        Font = Enum.Font.GothamMedium,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    local valueLabel = createInstance("TextLabel", {
        Name = "Value",
        Parent = container,
        Size = UDim2.new(0, 50, 0, 20),
        Position = UDim2.new(1, -60, 0, 8),
        BackgroundTransparency = 1,
        Text = tostring(default),
        TextColor3 = self.Library.Theme.Accent,
        TextSize = 13,
        Font = Enum.Font.GothamBold,
        TextXAlignment = Enum.TextXAlignment.Right
    })
    
    local sliderBackground = createInstance("Frame", {
        Name = "SliderBG",
        Parent = container,
        Size = UDim2.new(1, -20, 0, 4),
        Position = UDim2.new(0, 10, 1, -14),
        BackgroundColor3 = self.Library.Theme.Border,
        BorderSizePixel = 0
    })
    
    createInstance("UICorner", {
        Parent = sliderBackground,
        CornerRadius = UDim.new(1, 0)
    })
    
    local sliderFill = createInstance("Frame", {
        Name = "Fill",
        Parent = sliderBackground,
        Size = UDim2.new(0, 0, 1, 0),
        BackgroundColor3 = self.Library.Theme.Accent,
        BorderSizePixel = 0
    })
    
    createInstance("UICorner", {
        Parent = sliderFill,
        CornerRadius = UDim.new(1, 0)
    })
    
    local sliderButton = createInstance("Frame", {
        Name = "Button",
        Parent = sliderBackground,
        Size = UDim2.new(0, 12, 0, 12),
        Position = UDim2.new(0, 0, 0.5, 0),
        AnchorPoint = Vector2.new(0.5, 0.5),
        BackgroundColor3 = Color3.fromRGB(255, 255, 255),
        BorderSizePixel = 0
    })
    
    createInstance("UICorner", {
        Parent = sliderButton,
        CornerRadius = UDim.new(1, 0)
    })
    
    createInstance("UIStroke", {
        Parent = sliderButton,
        Color = self.Library.Theme.Accent,
        Thickness = 2
    })
    
    local value = default
    local dragging = false
    
    local function update(newValue)
        newValue = math.clamp(newValue, min, max)
        newValue = math.floor(newValue / increment) * increment
        value = newValue
        
        local percent = (value - min) / (max - min)
        sliderFill.Size = UDim2.new(percent, 0, 1, 0)
        sliderButton.Position = UDim2.new(percent, 0, 0.5, 0)
        valueLabel.Text = tostring(value)
        
        if flag then
            self.Library.Flags[flag] = value
        end
        
        callback(value)
    end
    
    sliderBackground.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            local mouse = UserInputService:GetMouseLocation()
            local percent = math.clamp((mouse.X - sliderBackground.AbsolutePosition.X) / sliderBackground.AbsoluteSize.X, 0, 1)
            update(min + (max - min) * percent)
        end
    end)
    
    sliderBackground.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local mouse = UserInputService:GetMouseLocation()
            local percent = math.clamp((mouse.X - sliderBackground.AbsolutePosition.X) / sliderBackground.AbsoluteSize.X, 0, 1)
            update(min + (max - min) * percent)
        end
    end)
    
    container.MouseEnter:Connect(function()
        tween(container, {BackgroundColor3 = self.Library.Theme.Hover}, 0.2)
    end)
    
    container.MouseLeave:Connect(function()
        tween(container, {BackgroundColor3 = self.Library.Theme.ElementBG}, 0.2)
    end)
    
    update(default)
    
    return {
        SetValue = update,
        GetValue = function() return value end
    }
end

function Tab:AddDropdown(config)
    config = config or {}
    
    local name = config.Name or "Dropdown"
    local options = config.Options or {"Option 1", "Option 2"}
    local default = config.Default
    local flag = config.Flag
    local callback = config.Callback or function() end
    
    local container = createInstance("Frame", {
        Name = "Dropdown",
        Parent = self.Content,
        Size = UDim2.new(1, 0, 0, 38),
        BackgroundColor3 = self.Library.Theme.ElementBG,
        BorderSizePixel = 0,
        ClipsDescendants = false
    })
    
    createInstance("UICorner", {
        Parent = container,
        CornerRadius = UDim.new(0, 6)
    })
    
    local label = createInstance("TextLabel", {
        Name = "Label",
        Parent = container,
        Size = UDim2.new(1, -35, 1, 0),
        Position = UDim2.new(0, 10, 0, 0),
        BackgroundTransparency = 1,
        Text = name,
        TextColor3 = self.Library.Theme.Text,
        TextSize = 13,
        Font = Enum.Font.GothamMedium,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    local valueLabel = createInstance("TextLabel", {
        Name = "Value",
        Parent = container,
        Size = UDim2.new(0, 0, 1, 0),
        Position = UDim2.new(1, -25, 0, 0),
        BackgroundTransparency = 1,
        Text = default or "None",
        TextColor3 = self.Library.Theme.SubText,
        TextSize = 12,
        Font = Enum.Font.Gotham,
        TextXAlignment = Enum.TextXAlignment.Right,
        AutomaticSize = Enum.AutomaticSize.X
    })
    
    local arrow = createInstance("TextLabel", {
        Name = "Arrow",
        Parent = container,
        Size = UDim2.new(0, 20, 1, 0),
        Position = UDim2.new(1, -20, 0, 0),
        BackgroundTransparency = 1,
        Text = "▼",
        TextColor3 = self.Library.Theme.SubText,
        TextSize = 10,
        Font = Enum.Font.Gotham
    })
    
    local optionsContainer = createInstance("Frame", {
        Name = "Options",
        Parent = container,
        Size = UDim2.new(1, 0, 0, 0),
        Position = UDim2.new(0, 0, 1, 5),
        BackgroundColor3 = self.Library.Theme.Secondary,
        BorderSizePixel = 0,
        Visible = false,
        ZIndex = 100
    })
    
    createInstance("UICorner", {
        Parent = optionsContainer,
        CornerRadius = UDim.new(0, 6)
    })
    
    createInstance("UIStroke", {
        Parent = optionsContainer,
        Color = self.Library.Theme.Border,
        Thickness = 1
    })
    
    createInstance("UIListLayout", {
        Parent = optionsContainer,
        SortOrder = Enum.SortOrder.LayoutOrder,
        Padding = UDim.new(0, 2)
    })
    
    createInstance("UIPadding", {
        Parent = optionsContainer,
        PaddingLeft = UDim.new(0, 5),
        PaddingRight = UDim.new(0, 5),
        PaddingTop = UDim.new(0, 5),
        PaddingBottom = UDim.new(0, 5)
    })
    
    local value = default
    local isOpen = false
    
    for _, option in ipairs(options) do
        local optionButton = createInstance("TextButton", {
            Name = option,
            Parent = optionsContainer,
            Size = UDim2.new(1, 0, 0, 30),
            BackgroundColor3 = self.Library.Theme.ElementBG,
            BorderSizePixel = 0,
            Text = option,
            TextColor3 = self.Library.Theme.Text,
            TextSize = 12,
            Font = Enum.Font.Gotham,
            ZIndex = 101
        })
        
        createInstance("UICorner", {
            Parent = optionButton,
            CornerRadius = UDim.new(0, 4)
        })
        
        optionButton.MouseButton1Click:Connect(function()
            value = option
            valueLabel.Text = option
            isOpen = false
            optionsContainer.Visible = false
            tween(arrow, {Rotation = 0}, 0.2)
            tween(container, {Size = UDim2.new(1, 0, 0, 38)}, 0.2)
            
            if flag then
                self.Library.Flags[flag] = value
            end
            
            callback(value)
        end)
        
        optionButton.MouseEnter:Connect(function()
            tween(optionButton, {BackgroundColor3 = self.Library.Theme.Hover}, 0.2)
        end)
        
        optionButton.MouseLeave:Connect(function()
            tween(optionButton, {BackgroundColor3 = self.Library.Theme.ElementBG}, 0.2)
        end)
    end
    
    local button = createInstance("TextButton", {
        Parent = container,
        Size = UDim2.new(1, 0, 0, 38),
        BackgroundTransparency = 1,
        Text = "",
        ZIndex = 2
    })
    
    button.MouseButton1Click:Connect(function()
        isOpen = not isOpen
        optionsContainer.Visible = isOpen
        
        if isOpen then
            tween(arrow, {Rotation = 180}, 0.2)
            local height = 10 + (#options * 32)
            optionsContainer.Size = UDim2.new(1, 0, 0, height)
            tween(container, {Size = UDim2.new(1, 0, 0, 38 + height + 5)}, 0.2)
        else
            tween(arrow, {Rotation = 0}, 0.2)
            tween(container, {Size = UDim2.new(1, 0, 0, 38)}, 0.2)
        end
    end)
    
    container.MouseEnter:Connect(function()
        tween(container, {BackgroundColor3 = self.Library.Theme.Hover}, 0.2)
    end)
    
    container.MouseLeave:Connect(function()
        tween(container, {BackgroundColor3 = self.Library.Theme.ElementBG}, 0.2)
    end)
    
    if default then
        valueLabel.Text = default
        value = default
    end
    
    return {
        SetValue = function(newValue)
            value = newValue
            valueLabel.Text = newValue
            if flag then
                self.Library.Flags[flag] = value
            end
            callback(value)
        end,
        GetValue = function() return value end,
        SetOptions = function(newOptions)
            for _, child in ipairs(optionsContainer:GetChildren()) do
                if child:IsA("TextButton") then
                    child:Destroy()
                end
            end
            
            options = newOptions
            
            for _, option in ipairs(options) do
                local optionButton = createInstance("TextButton", {
                    Name = option,
                    Parent = optionsContainer,
                    Size = UDim2.new(1, 0, 0, 30),
                    BackgroundColor3 = self.Library.Theme.ElementBG,
                    BorderSizePixel = 0,
                    Text = option,
                    TextColor3 = self.Library.Theme.Text,
                    TextSize = 12,
                    Font = Enum.Font.Gotham,
                    ZIndex = 101
                })
                
                createInstance("UICorner", {
                    Parent = optionButton,
                    CornerRadius = UDim.new(0, 4)
                })
                
                optionButton.MouseButton1Click:Connect(function()
                    value = option
                    valueLabel.Text = option
                    isOpen = false
                    optionsContainer.Visible = false
                    tween(arrow, {Rotation = 0}, 0.2)
                    tween(container, {Size = UDim2.new(1, 0, 0, 38)}, 0.2)
                    
                    if flag then
                        self.Library.Flags[flag] = value
                    end
                    
                    callback(value)
                end)
            end
        end
    }
end

function Tab:AddTextbox(config)
    config = config or {}
    
    local name = config.Name or "Textbox"
    local default = config.Default or ""
    local placeholder = config.Placeholder or "Enter text..."
    local flag = config.Flag
    local callback = config.Callback or function() end
    
    local container = createInstance("Frame", {
        Name = "Textbox",
        Parent = self.Content,
        Size = UDim2.new(1, 0, 0, 65),
        BackgroundColor3 = self.Library.Theme.ElementBG,
        BorderSizePixel = 0
    })
    
    createInstance("UICorner", {
        Parent = container,
        CornerRadius = UDim.new(0, 6)
    })
    
    local label = createInstance("TextLabel", {
        Name = "Label",
        Parent = container,
        Size = UDim2.new(1, -20, 0, 20),
        Position = UDim2.new(0, 10, 0, 8),
        BackgroundTransparency = 1,
        Text = name,
        TextColor3 = self.Library.Theme.Text,
        TextSize = 13,
        Font = Enum.Font.GothamMedium,
        TextXAlignment = Enum.TextXAlignment.Left
    })
    
    local textbox = createInstance("TextBox", {
        Name = "Input",
        Parent = container,
        Size = UDim2.new(1, -20, 0, 28),
        Position = UDim2.new(0, 10, 1, -36),
        BackgroundColor3 = self.Library.Theme.Background,
        BorderSizePixel = 0,
        Text = default,
        PlaceholderText = placeholder,
        TextColor3 = self.Library.Theme.Text,
        PlaceholderColor3 = self.Library.Theme.SubText,
        TextSize = 12,
        Font = Enum.Font.Gotham,
        TextXAlignment = Enum.TextXAlignment.Left,
        ClearTextOnFocus = false
    })
    
    createInstance("UICorner", {
        Parent = textbox,
        CornerRadius = UDim.new(0, 4)
    })
    
    createInstance("UIPadding", {
        Parent = textbox,
        PaddingLeft = UDim.new(0, 8),
        PaddingRight = UDim.new(0, 8)
    })
    
    textbox.FocusLost:Connect(function()
        local value = textbox.Text
        
        if flag then
            self.Library.Flags[flag] = value
        end
        
        callback(value)
    end)
    
    container.MouseEnter:Connect(function()
        tween(container, {BackgroundColor3 = self.Library.Theme.Hover}, 0.2)
    end)
    
    container.MouseLeave:Connect(function()
        tween(container, {BackgroundColor3 = self.Library.Theme.ElementBG}, 0.2)
    end)
    
    return {
        SetValue = function(newValue)
            textbox.Text = newValue
            if flag then
                self.Library.Flags[flag] = newValue
            end
            callback(newValue)
        end,
        GetValue = function() return textbox.Text end
    }
end

-- Initialize and return
return Library
